# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è Portainer

## üöÄ –î–µ–ø–ª–æ–π –∑–∞ 5 –º–∏–Ω—É—Ç

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–§–∞–π–ª `stack.env` —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ä—Ç –∏–ª–∏ URL):
```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ stack.env
nano stack.env
```

### –®–∞–≥ 2: –î–µ–ø–ª–æ–π –≤ Portainer

#### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ Git Repository (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –í Portainer –æ—Ç–∫—Ä–æ–π—Ç–µ: **Stacks** ‚Üí **Add stack**
2. –í—ã–±–µ—Ä–∏—Ç–µ **Repository**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Name**: `biveki-site`
   - **Repository URL**: URL –≤–∞—à–µ–≥–æ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
   - **Reference**: `main` (–∏–ª–∏ –≤–∞—à–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞)
   - **Compose path**: `docker-compose.yml`
4. ‚ú® **Environment variables –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –∏–∑ `stack.env` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
5. –ù–∞–∂–º–∏—Ç–µ **Deploy the stack**

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Web Editor

1. –í Portainer –æ—Ç–∫—Ä–æ–π—Ç–µ: **Stacks** ‚Üí **Add stack**
2. –í—ã–±–µ—Ä–∏—Ç–µ **Web editor**
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è: `biveki-site`
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `docker-compose.yml` –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
5. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ **Environment variables**
6. –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∞—à–µ–≥–æ `stack.env` —Ñ–∞–π–ª–∞
7. –ù–∞–∂–º–∏—Ç–µ **Deploy the stack**

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. –í Portainer –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Containers**
2. –ù–∞–π–¥–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `biveki-app` ‚Üí –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É **Console** ‚Üí –Ω–∞–∂–º–∏—Ç–µ **Connect**
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã:
   ```bash
   npx prisma db push
   npm run db:seed
   ```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:3022`

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ health endpoint: `http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:3022/api/health`

## üìã –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ü–æ—Ä—Ç—ã
- **–í–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç**: 3022 (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `stack.env` —á–µ—Ä–µ–∑ `EXTERNAL_PORT`)
- **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç**: 3000 (–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–§–∞–π–ª `stack.env` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ–µ–º:**

```env
# –í–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω –∏–ª–∏ IP
NEXTAUTH_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.com

# –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç
EXTERNAL_PORT=3022
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≤–Ω–µ—à–Ω—é—é** PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
- –ë–î –¥–æ—Å—Ç—É–ø–Ω–∞ —Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ —É–∫–∞–∑–∞–Ω `DATABASE_URL` –≤ `stack.env`
- –û—Ç–∫—Ä—ã—Ç –ø–æ—Ä—Ç 5432 (–∏–ª–∏ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç –≤–∞—à–µ–π –ë–î)

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
–í Portainer: **Containers** ‚Üí `biveki-app` ‚Üí **Logs**

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
–í Portainer: **Stacks** ‚Üí `biveki-site` ‚Üí **Stop** / **Start**

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
–í Portainer: **Stacks** ‚Üí `biveki-site` ‚Üí **Pull and redeploy**

## ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. ‚úÖ –§–∞–π–ª `stack.env` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ **–ø—Ä–∏–≤–∞—Ç–Ω–æ–º** Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
2. ‚ùå **–ù–ï –ø—É–±–ª–∏–∫—É–π—Ç–µ** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏
3. ‚úÖ –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS (–Ω–∞—Å—Ç—Ä–æ–π—Ç–µ nginx/traefik —Å SSL)
4. ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## üÜò –ü–æ–º–æ—â—å

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [DEPLOYMENT.md](./DEPLOYMENT.md)

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
```bash
docker logs biveki-app
```

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ `stack.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î —Å —Ö–æ—Å—Ç–∞: `psql $DATABASE_URL`

**–ü–æ—Ä—Ç –∑–∞–Ω—è—Ç:**
- –ò–∑–º–µ–Ω–∏—Ç–µ `EXTERNAL_PORT` –≤ `stack.env`
- –ò–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ –ø–æ—Ä—Ç 3022

**Portainer –Ω–µ –≤–∏–¥–∏—Ç stack.env:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª `stack.env` –µ—Å—Ç—å –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ–Ω –∑–∞–∫–æ–º–º–∏—á–µ–Ω –≤ Git
- –ü—Ä–∏ –¥–µ–ø–ª–æ–µ —á–µ—Ä–µ–∑ Repository —Ñ–∞–π–ª –ø–æ–¥—Ç—è–Ω–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
